// Path: homeroom-service/prisma/schema.prisma

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// Model ini menetapkan GURU mana yang menjadi WALI KELAS untuk KELAS mana
model Homeroom {
  id        Int      @id @default(autoincrement())
  teacherId Int      @unique // ID Guru dari user-service
  classId   Int      @unique // ID Kelas dari class-content-service
  
  // Relasi ke daftar siswa yang ada di kelas perwalian ini
  students  HomeroomStudent[]
}

// Model ini adalah TABEL PENGHUBUNG antara Homeroom dan Siswa
model HomeroomStudent {
  id         Int      @id @default(autoincrement())
  studentId  Int      // ID Siswa dari user-service
  
  homeroomId Int
  homeroom   Homeroom @relation(fields: [homeroomId], references: [id])

  // Pastikan satu siswa hanya bisa terdaftar sekali di satu kelas perwalian
  @@unique([studentId, homeroomId])
}

// Model untuk menyimpan CATATAN yang dibuat wali kelas untuk siswa
model StudentNote {
  id        Int      @id @default(autoincrement())
  content   String
  studentId Int
  authorId  Int      // ID Wali Kelas yang menulis catatan
  classId   Int      // Konteks kelas saat catatan dibuat
  type      String   @default("BIMBINGAN_KONSELING")
  createdAt DateTime @default(now())
}